#!/bin/bash
# rapidget - Downloadmanager for rapidshare
# Author: Alexander Surma <surma@drebesium.org> - released under GPL

# Settings
TEMPDIR=$(mktemp -d rapidget.XXX)
COOKIEFILE="${HOME}/.rapidget"

REAUTH="n"
FILE="n"
APPNAME=$(basename "${0}")
VERSION=2.0

version()
{
	echo "${APPNAME} v${VERSION}"
}

usage()
{
	version
	echo " [OPTIONS] <URL> [wget OPTIONS]"
	echo "Options:"
	echo "  -f		URL is a file containing a list of URLs rather than a single URL"
	echo "  -c PATH 	User this file instead of the default file for cookies (i.e. ~/.rapidget)"
	echo "  -v		Print version"
	echo "  -h		This message"
	mkill $@
}

cleanup()
{
	[ -d "${TEMPDIR}" ] && rm -rf "${TEMPDIR}"
}

mkill()
{
	cleanup
	exit ${1-1}
}

error()
{
	echo "${APPNAME}: ${1}" >&2
	mkill ${2} 
}

trap mkill INT TERM

while getopts ":vhc:f" arg; do
	case "${arg}" in
		f) FILE="y" ;;
		c) COOKIEFILE="${OPTARG}" ;;
		v) version ; mkill 0 ;;
		h) usage 0 ;;
		:) error "${OPTARG} requires an argument" ;;
		?) usage 1 ;;
	esac
done
cleanup
